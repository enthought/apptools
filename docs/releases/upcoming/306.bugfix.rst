Use context managers to handle locks in apptools.preferences (#306)